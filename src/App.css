* { margin: 0; padding: 0; box-sizing: border-box; }
html, body, #root { height: 100%; width: 100%; overflow: hidden; position: fixed; top: 0; left: 0; right: 0; bottom: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }

.app { height: 100%; display: flex; flex-direction: column; transition: all 0.3s; }
.app.dark { background: #0d1117; color: #e6edf3; }
.app.light { background: #f6f8fa; color: #24292f; }

.main-content { flex: 1; overflow-y: auto; overflow-x: hidden; padding-bottom: 70px; -webkit-overflow-scrolling: touch; }

/* 首页 */
.home-page { padding: 20px; }
.home-page h1 { font-size: 28px; text-align: center; margin-bottom: 8px; }
.subtitle { text-align: center; opacity: 0.7; margin-bottom: 24px; }
.quick-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 24px; }
.quick-card { background: linear-gradient(135deg, #238636 0%, #1f6feb 100%); border-radius: 16px; padding: 20px 12px; text-align: center; cursor: pointer; transition: transform 0.2s; }
.quick-card:active { transform: scale(0.95); }
.quick-card .icon { font-size: 28px; display: block; margin-bottom: 8px; }
.quick-card span:last-child { font-size: 13px; font-weight: 500; }
.history-section h3 { margin-bottom: 12px; font-size: 16px; }
.history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.history-header h3 { margin: 0; }
.history-filter { display: flex; gap: 8px; }
.history-filter button { padding: 6px 12px; border-radius: 16px; border: none; font-size: 12px; background: rgba(255,255,255,0.1); color: inherit; cursor: pointer; transition: all 0.2s; }
.history-filter button.active { background: #238636; color: white; }
.history-filter button:active { transform: scale(0.95); }
.history-list { max-height: 300px; overflow-y: auto; }
.history-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-radius: 10px; margin-bottom: 8px; font-size: 13px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
.history-item:active { transform: scale(0.98); opacity: 0.8; }
.history-item-left { display: flex; align-items: center; gap: 10px; flex: 1; min-width: 0; }
.history-category { padding: 3px 8px; border-radius: 10px; font-size: 10px; color: white; flex-shrink: 0; }
.history-item .expr { opacity: 0.8; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.history-item .res { font-weight: 600; flex-shrink: 0; margin-left: 10px; }
.empty { text-align: center; opacity: 0.5; padding: 20px; }

/* 计算器 */
.calc-page { display: flex; flex-direction: column; height: 100%; padding: 8px; }
.display-area { background: #161b22; border-radius: 16px; padding: 16px; margin-bottom: 8px; }
.expression { font-size: 14px; color: #8b949e; height: 20px; text-align: right; }
.display { font-size: 36px; font-weight: 300; text-align: right; word-break: break-all; min-height: 48px; font-family: 'SF Mono', monospace; }
.status-bar { display: flex; gap: 12px; font-size: 12px; margin-top: 8px; }
.status-bar span { opacity: 0.5; }
.status-bar span.active { opacity: 1; color: #f78166; }

.sci-panel { margin-bottom: 8px; }
.sci-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; margin-bottom: 4px; }
.sci-row button { background: #21262d; border: 1px solid transparent; border-radius: 8px; padding: 12px 4px; font-size: 12px; color: #e6edf3; cursor: pointer; transition: all 0.1s; -webkit-tap-highlight-color: transparent; }
.sci-row button:active { transform: scale(0.92); opacity: 0.8; }
.light .sci-row button { background: #e1e4e8; color: #24292f; }

.num-panel { flex: 1; display: flex; flex-direction: column; gap: 6px; }
.num-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; flex: 1; }
.num-row button { background: #21262d; border: none; border-radius: 14px; font-size: 24px; font-weight: 500; color: #e6edf3; cursor: pointer; transition: all 0.1s; -webkit-tap-highlight-color: transparent; }
.num-row button:active { transform: scale(0.92); opacity: 0.8; }
.num-row button.func { font-size: 18px; }
.num-row button.op { color: white; }
.num-row button.eq { color: white; }
.light .num-row button { background: #ffffff; color: #24292f; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.light .num-row button.op { background: #0969da; }
.light .num-row button.eq { background: #1a7f37; }

/* 测绘 */
.survey-page { padding: 12px; padding-bottom: 100px; }
.survey-search { margin-bottom: 12px; }
.survey-search input { width: 100%; padding: 12px 16px; font-size: 15px; border-radius: 12px; border: 1px solid #30363d; background: #21262d; color: #e6edf3; }
.survey-search input::placeholder { color: #8b949e; }
.light .survey-search input { background: #fff; border-color: #d0d7de; color: #24292f; }
.type-selector { margin-bottom: 16px; }
.type-selector select { width: 100%; padding: 14px 16px; font-size: 16px; border-radius: 12px; border: 1px solid #30363d; background: #21262d; color: #e6edf3; }
.light .type-selector select { background: #fff; border-color: #d0d7de; color: #24292f; }

.survey-form { margin-bottom: 16px; }
.input-row { display: flex; align-items: center; margin-bottom: 10px; }
.input-row label { width: 110px; font-size: 14px; flex-shrink: 0; }
.input-row input { flex: 1; padding: 12px; border-radius: 8px; border: 1px solid #30363d; background: #161b22; color: #e6edf3; font-size: 15px; }
.light .input-row input { background: #fff; border-color: #d0d7de; color: #24292f; }

.table-header, .table-row, .table-row-4 { display: grid; gap: 6px; margin-bottom: 6px; font-size: 13px; }
.table-header { grid-template-columns: 40px 1fr 1fr; padding: 8px 0; font-weight: 600; opacity: 0.7; }
.table-row { grid-template-columns: 40px 1fr 1fr; }
.table-row span { display: flex; align-items: center; justify-content: center; }
.table-row input { padding: 10px 8px; border-radius: 6px; border: 1px solid #30363d; background: #161b22; color: #e6edf3; font-size: 14px; }
.light .table-row input { background: #fff; border-color: #d0d7de; color: #24292f; }

.table-row-4 { grid-template-columns: 30px 1fr 1fr 1fr 1fr; }
.table-row-4 input { padding: 8px 4px; font-size: 12px; }

.point-row { display: grid; grid-template-columns: 30px 1fr 1fr; gap: 6px; margin-bottom: 6px; }
.point-row input { padding: 10px 8px; border-radius: 6px; border: 1px solid #30363d; background: #161b22; color: #e6edf3; }
.light .point-row input { background: #fff; border-color: #d0d7de; color: #24292f; }

.transform-header { font-size: 14px; font-weight: 600; margin-bottom: 12px; margin-top: 12px; }

.select-row { display: flex; align-items: center; margin-bottom: 10px; }
.select-row label { width: 110px; font-size: 14px; flex-shrink: 0; }
.select-row select { flex: 1; padding: 12px; border-radius: 8px; border: 1px solid #30363d; background: #161b22; color: #e6edf3; font-size: 15px; }
.light .select-row select { background: #fff; border-color: #d0d7de; color: #24292f; }

.calc-btn { width: 100%; padding: 16px; font-size: 18px; font-weight: 600; border: none; border-radius: 12px; background: linear-gradient(135deg, #238636, #1f6feb); color: white; cursor: pointer; margin-bottom: 16px; }
.calc-btn:active { opacity: 0.9; transform: scale(0.98); }

.survey-result { background: #161b22; border: 2px solid #238636; border-radius: 12px; padding: 16px; }
.survey-result pre { white-space: pre-wrap; word-break: break-word; font-size: 14px; line-height: 1.8; font-family: 'SF Mono', Consolas, monospace; }
.light .survey-result { background: #fff; border-color: #1a7f37; }

/* 设置 */
.settings-page { padding: 20px; }
.settings-page h2 { margin-bottom: 24px; font-size: 24px; }
.setting-item { display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid #21262d; }
.light .setting-item { border-color: #d0d7de; }
.setting-item select { padding: 10px 16px; border-radius: 8px; border: 1px solid #30363d; background: #21262d; color: #e6edf3; font-size: 14px; }
.light .setting-item select { background: #fff; border-color: #d0d7de; color: #24292f; }
.toggle { padding: 8px 20px; border-radius: 20px; border: none; font-size: 14px; cursor: pointer; background: #30363d; color: #8b949e; transition: all 0.2s; }
.toggle:active { transform: scale(0.95); }
.toggle.on { background: #238636; color: white; }
.theme-selector { display: flex; gap: 8px; }
.theme-btn { width: 32px; height: 32px; border-radius: 50%; border: none; cursor: pointer; font-size: 12px; color: white; font-weight: bold; transition: all 0.2s; }
.theme-btn:active { transform: scale(0.9); }
.theme-btn.active { box-shadow: 0 0 0 3px rgba(255,255,255,0.5); }
.danger { padding: 8px 20px; border-radius: 20px; border: none; font-size: 14px; cursor: pointer; background: #da3633; color: white; transition: all 0.2s; }
.danger:active { transform: scale(0.95); opacity: 0.8; }
.about { text-align: center; margin-top: 40px; opacity: 0.6; font-size: 13px; }
.about p { margin-bottom: 4px; }

/* 底部导航 */
.bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; height: 64px; display: flex; background: #161b22; border-top: 1px solid #21262d; padding-bottom: env(safe-area-inset-bottom); z-index: 100; }
.light .bottom-nav { background: #fff; border-color: #d0d7de; }
.bottom-nav button { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; border: none; background: transparent; color: #8b949e; font-size: 11px; cursor: pointer; padding: 8px 0; }
.bottom-nav button span { font-size: 20px; }
.bottom-nav button.active { color: #58a6ff; }
.light .bottom-nav button.active { color: #0969da; }
